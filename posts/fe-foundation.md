---
title: 对于前端工程的思考
date: 2021-12-14 10:47:47
tags: [web, foundation]
publish: false
---

_此文，仅是自己对过去的一个梳理，其中的 **最佳实践** 和 **总结** 并不一定 **正确**，请酌情阅读，也欢迎讨论。_

在当前的公司也有差不多两年了，项目接触了差不多十几个，自己搭建的项目也有不少。纵观之前接手的项目，以及现在的新项目，
多多少少有点沉淀，写一写，记一记。

因为公司没有架构师，而且前前后后接触了几个项目组，每个项目组都有自己的风格。有的用 Vue， 有的用 React，还有一些老项目
用的 jQuery 那一套。

<!-- more -->

## 起因

因为接触的项目多了，做的事情自然有一些重复的，而于我个人来讲，最烦的事情莫过于同样的事情做三遍。

于此，记一记关于 **工程项目** 相关的思考。包括：

1. 规范，包括项目结构规范，代码规范，前后端协议（接口）规范
2. 项目编译，如 webpack 等编译工具
3. 持续集成，包括自动化测试，发布，回滚
4. 最佳实践，基于本人目前的经历，总结出的相关最佳实践

## 规范

在此处，不赘述 **规范** 相关优势和劣势。仅记录实践过程的相关思考和结果。

如果是个人项目，倒是不必有过多的约束。按照自己熟悉的来就行了。那么对于一个多人合作的项目呢？

### 代码规范

讲讲坑吧，到这个公司接手的第一个项目是老项目，jQuery 那种，可以看出，项目其实比较老了，十几年了吧。
项目没有代码规范，结构/目录规范也没有，开放度极高，想怎么写，就怎么写，只要能跑起来就行。

而且中间已经经手了很多个人，每个人的风格都有点不同。开发这样代码的痛苦，大概只有类似经历的人才知道吧。

而且，这个公司的人，遇到代码问题，都喜欢看最后一个 commit 的人，直接去找对应的人问这段代码怎么回事，
这导致，大家都不用插件去格式化代码。因为一旦格式化了，会导致，本来是别人写的代码，被你格式化了，最后一个
commit 的人就变成了你，如果有问题，就直接来问你了。（这里的 **问** 更像是质问，问你为什么要这么写。）

这也就导致，代码的格式非常乱（例如运算符前后没有空格，tab/space 混用），对于一个有点代码洁癖的人来讲，这能忍？

坑讲完了，讲讲怎么改的吧，对于这样的老项目，肯定不能直接大改，需要一点一点来。

因为是老项目，ES 3/4/5 的语法都有，这导致直接引入 eslint 中的 recommended 规则来校验，会有一大推报错。
而且用 `eslint --fix` 之后，代码不能运行了！！！QAQ

按照 eslint 的说明来看，不应该呀，毕竟 `eslint --fix` 只会修复不影响编译的相关代码风格，那么问题是啥呢？
查找之后，发现是 webpack 打包的问题，webpack 打包的配置，比较老，不支持 es6，而且有一些自定义的插件。
这与 eslint 的某些配置有一些冲突，例如不能用 `var` 关键字。

这个时候，就不是一个简单的代码规范的问题了。这俨然变成了另外一个复杂的东西，webpack 编译打包的配置有点问题。
看来引入 eslint 是无望了？倒也不是，后来采用妥协的做法，仅引入 eslint 作为校验，不做强制风格修复。
只告诉你有这个风格问题，至于改不改，就看写代码的人自己了（因为公司的人觉得 code review 意义不大，也从来没有组织过 code review，
所以只能靠自觉）。

> 吐槽一句，在现在公司看来，只有能带来收入的事情，才会考虑投入。
>
> 个人认为，如果是中小型公司，这么做，是 **正确** 的，首要考虑的一定是如何活下去。
>
> 所以，上面做的事情，也仅仅是因为个人实在无法忍受老代码的规范问题，做的一点点 **改进**。
